name: Extract ZIP Files
on:
  workflow_dispatch:
    inputs:
      zip_file:
        description: 'ZIP file name (e.g., tutorial.zip)'
        required: true
        default: 'tutorial.zip'
      target_folder:
        description: 'Target folder name (use "." for root)'
        required: true
        default: '.'

jobs:
  unzip:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v4
      
      - name: Extract and commit ZIP contents
        run: |
          # Check if ZIP file exists
          if [ ! -f "${{ inputs.zip_file }}" ]; then
            echo "‚ùå ZIP file ${{ inputs.zip_file }} not found!"
            exit 1
          fi
          
          # Handle extraction based on target folder
          if [ "${{ inputs.target_folder }}" = "." ]; then
            echo "üì¶ Extracting ${{ inputs.zip_file }} to root directory..."
            unzip -o "${{ inputs.zip_file }}"
          else
            # Remove target folder if exists (only if not root)
            rm -rf "${{ inputs.target_folder }}"
            
            # Create target folder
            mkdir -p "${{ inputs.target_folder }}"
            
            # Extract ZIP file to target folder
            echo "üì¶ Extracting ${{ inputs.zip_file }} to ${{ inputs.target_folder }}/..."
            unzip "${{ inputs.zip_file }}" -d "${{ inputs.target_folder }}/"
          fi
          
          # Remove the ZIP file after extraction
          rm "${{ inputs.zip_file }}"
          
          # Configure git
          git config --local user.email "github-actions@users.noreply.github.com"
          git config --local user.name "github-actions"
          
          # Add and commit changes
          git add .
          git commit -m "Extract ${{ inputs.zip_file }} to ${{ inputs.target_folder }}"
          git push origin main
          
          echo "‚úÖ Successfully extracted and committed files!"
