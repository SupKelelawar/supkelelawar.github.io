name: Extract Files
on: 
  workflow_dispatch:
    inputs:
      source_folder:
        description: 'Source folder'
        required: true
        default: '.'
      destination_folder:
        description: 'Destination folder'
        required: true
        default: 'extracted'

jobs:
  extract:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
    - uses: actions/checkout@v4
    
    - name: Extract ZIP files
      run: |
        mkdir -p ${{ inputs.destination_folder }}
        cd ${{ inputs.source_folder }}
        
        if ls *.zip 1> /dev/null 2>&1; then
          for zipfile in *.zip; do
            echo "Extracting: $zipfile"
            unzip -q "$zipfile" -d "../${{ inputs.destination_folder }}/"
          done
          echo "✅ Extraction completed!"
        else
          echo "❌ No ZIP files found"
        fi
        
    - name: Commit extracted files to repository
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        
        # Check if there are any changes
        if [ -n "$(git status --porcelain)" ]; then
          git add ${{ inputs.destination_folder }}/
          git commit -m "Extract files to ${{ inputs.destination_folder }}"
          git push
          echo "✅ Files committed and pushed to repository"
        else
          echo "ℹ️ No new files to commit (files already exist in repository)"
        fi